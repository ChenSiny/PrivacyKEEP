# 运动隐私保护演示系统 (PrivacyKEEP)

一个包含前端 (Vue3 + Vite) 与后端 (FastAPI + SQLite + SQLAlchemy) 的课程设计，展示在运动轨迹场景中应用差分隐私、匿名群组与环签名，实现匿名热力图与群组排行榜，探索隐私保护、用户体验与数据可分析的平衡。

## 运行环境要求

- Python ≥ 3.10
- Node.js ≥ 16 (建议 18+)

## 后端快速启动（FastAPI）

```bash
cd backend
pip install -r requirements.txt  # 若 coincurve 安装失败仍可运行：它有降级逻辑
uvicorn main:app --reload --port 8000
# 访问: http://localhost:8000/docs 查看接口文档
```

## 前端快速启动（Vite + Vue3）

```bash
cd frontend
npm install
npm run dev
# 访问: http://localhost:3000
```

## 数据流程概览（端到端）

1. 运动中：客户端每秒生成当前位置点 → 本地数组（不上传）。
2. 结束：网格化 (gpsToGrid) + 差分隐私处理 (Laplace 噪声) → 净化区块列表。
3. 上传：POST `/api/heatmap/data`（仅 x,y,weight）。
4. 请求环：POST `/api/leaderboard/request-ring` → 返回 `ring_id` + `ring_public_keys` + `group_name`。
5. 真实环签名：前端以 `ring_id|total_distance|average_pace` 生成 `{c0,s[]}`。
6. 提交成绩：POST `/api/leaderboard/submit-score-ring`，后端验证挑战闭合 → 入库。
7. 地图/排行榜：右侧浮层展示最新匿名群组排行榜。

以隐私保护为核心，下表为威胁模型设计与防护

| 攻击者                       | 攻击目标/能力                                                | 系统的防御措施                                               |
| :--------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| **“诚实但好奇”的后端服务器** | 1. 试图从热力图数据中推断出特定用户的精确位置。 2. 试图将排行榜上的成绩与用户的真实身份关联。 3. 试图构建用户的运动档案（如常去地点、运动习惯）。 | 1. **防御成功**：差分隐私保证无法从加噪后的热力图中确定任何个体是否出现在某个区块。 2. **防御成功**：环签名使得服务器无法确定签名来自环中的哪个具体成员。匿名ID本身也无法直接关联身份。 3. **部分防御**：服务器无法通过环签名链接同一用户的多次运动，因此无法构建完整的纵向行为档案。但单次运动的元数据（如总距离）仍被服务器知晓。 |
| **其他恶意用户**             | 1. 窥探其他用户的个人轨迹和实时动态。 2. 向排行榜上传虚假成绩，破坏公平性。 3. 试图对排行榜上的成绩进行“去匿名化”，找出对应的人。 | 1. **防御成功**：原始轨迹数据从未离开用户设备。 2. **防御成功**：环签名保证了只有拥有私钥的合法注册用户才能生成有效的签名，伪造成绩不可行。 3. **防御成功**：环签名提供了群体匿名性，其他用户只能看到群体成绩，无法得知具体是谁贡献了哪个成绩。 |
| **外部数据窃取者**           | 窃取服务器数据库，获得所有存储的数据。                       | 1. **防御成功**：数据库中不包含任何原始轨迹数据。 2. **防御成功**：热力图数据是加噪后的，价值有限。 3. **防御成功**：排行榜数据是匿名和群体化的，无法直接映射到个人。但匿名ID和环签名数据本身被泄露。 |
| **全局被动攻击者**           | 监听网络传输过程中的所有数据。                               | 1. **防御成功**：所有上传数据都已经过隐私化处理（差分隐私、匿名化）。即使被截获，也无法恢复出原始隐私信息。 2. **建议补充**：在所有通信链路上使用**HTTPS/TLS**加密，以防御此威胁。 |